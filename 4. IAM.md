# IAM

AWS 서비스와 리소스에 대한 액세스를 안전하게 관리할 수 있습니다. 또한 AWS사용자 및 그룹을 만들고 관리하며 AWS리소스에 대한 액세스를 허용 및 거부할 수 있습니다.

- AWS어카운트 관리 및 리소스/ 사용자/ 서비스의 권한 제어
  - 서비스 사용을 위한 인증 정보 부여
- 사용자의 생성 및 관리 및 계정의 보안
  - 사용자의 패스워드 정책 관리(일정 시간마다 패스워드 변경 등)
- 다른 계정과의 리소스 공유
  - Identity Federation(Facebbok 로그인, Google 로그인 등등)
- 계정에 별명 부여 가능 -> 로그인 주소 생성 가능
- IAM은 글로벌 서비스

# IAM 구성

크게 4가지로 나뉘어 있음.

- 사용자
  - 실제 AWS를 사용하는 사람 혹은 어플리케이션
- 그룹

  - 사용자의 집합
  - 그룹에 속한 사용자는 그룹에 부여된 권한을 행사
    - 개발 1팀, 개발 2팀, 디자인 팀 등등..

- 정책
  - 사용자와 그룹, 역할이 무엇을 할 수 있는지에 대한 문서
    - 개발팀은 이것을 할 수 있게 만들고 디자인 팀은 저 것을 할 수 있게 만들고..
  - JSON형식으로 정의
- 역할
  - AWS리소스에 부여하여 AWS리소스가 무엇을 할 수 있는지 정의
  - 혹은 다른 사용자가 역할을 부여받아 사용
  - 다른 자격에 대해서 신뢰관계 구축 가능
  - 역할을 바꾸어 가며 서비스를 사용 가능

![IAM의 권한 검증](https://user-images.githubusercontent.com/71562311/208005374-3c7e9a53-36c7-49ff-a10a-fcb1ab1c135d.png)

예를 들어 람다에서 S3 서비스를 이용하고 싶다면

- Lambda가 부여받은 역할이 S3를 이용할 수 있는 정책이 붙어 있는지를 확인해 접근을 허용하거나 불가하게 하는 것.

---

## 사용자의 종류

- 루트 사용자: 결제 관리를 포함한 계정의 모든 권한을 가지고 있음.
  - 관리 목적 이외에 다른 용도로 사용하지 않는 것을 권장
  - 탈취 되었을 때 복구가 매우 어려움 -> MFA를 설정하는 것을 권장
  - MFA : 일회용 패스워드를 생성하여 로그인
- IAM 사용자: IAM을 통해 생성해서 사용하는 사용자
  - 한 사람 혹은 하나의 어플리케이션을 의미
  - 설정 시 콘솔 로그인 권한 부여 가능
  - 설정 시 AWS 서비스를 이용할 수 있음
    - Access Key
    - Secret Access Key
  - AdminAccess를 부여하더라도 루트 사용자로 별도의 설정을 하지 않으면 Billing기능을 사용할 수 없음.

## IAM 자격 증명 보고서

- 계정의 모든 사용자와 암호, 엑세스 키, MFA장치등의 증명 상태를 나열하는 보고서를 생성하고 다운로드 가능
- 4시간에 한 번 생성 가능
- AWS 콘솔, CLI, API에서 생성 요청 및 다운로드 가능
- 포함되는 정보

IAM에서 자격증명 보고서를 다운받을 수 있음.

---

## IAM 모범 사용 사례

- 루트 사용자는 사용하지 않기
- 불필요한 사용자는 만들지 않기
- 가능하면 그룹과 정책을 사용하기
- 최소한의 권한만들 허용하는 습관을 들이기
- MFA를 활성화 하기
- AccessKey 대신 역할을 활용하기
- IAM 자격 증명 보고서 활용하기
